<!DOCTYPE html>
<html>
<head>
  <title>Our Project Website</title>
  <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body onload="logData()">
  <div class='topbar'>
    <a href='./#'>PG FOODS</a>
    <div class = 'barright'>
      <a href='./about/'>About</a>
      <a href='./establishments/'>Establishments</a>
      <a href='./statistics/'>Statistics</a>
      <a href='./faqs/'>FAQs</a>
    </div>
  </div>
  <div class='head'>
    <h1>PG Foods</h1>
    <em>Dedicated to encouraging informed Prince George's county food decisions</em>
  </div>
  <div class='content'>
    <div class='search-container'>
        <input type='text' placeholder='search' name='search'>
        <button type="submit"><i class="fa fa-search"></i></button>
    </div>
    <button class="button" onclick="loadData()">Load Some JSON from a server</button>
    <ul class='templist'></ul>
  </div>
  <script>
    function loadData() {
      console.log('fetch'); // confirm code is running on click
      fetch('/allEstablishments')
        .then(res => res.json())
        .then(res => {
          var string = '';
          //console.log(res); // logging step to check what we got
          var d = res.data;
          for (i in d) {
            let t = d[i];
            //console.log(res[i]);
            string += '<li>'+t.establishment_id+', '+t.name+'</li>';
          }
          document.querySelector(".templist").innerHTML = '<ol>'+string+'</ol>';
          return res;
        });
    }

    function logData(){
      fetch('/allEstablishments')
         .then(res => {
          console.log(res.status);
          return res.json();
         })
         .then(res => {
           console.log(res); // logging step to check what we got
           return res;
         })
         .catch((err) => {
           console.log(err);
         });
    }
  </script>
</body>
</html>
